Sub CalculerMoyenneButsEncaissesParMatch()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    
    ' Spécifiez la feuille de calcul contenant les données
    Set ws = ThisWorkbook.Sheets("LeagueTableExport")
    
    ' Trouver la dernière ligne avec des données
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Parcourir les lignes du tableau
    For i = 2 To lastRow ' Commence à la ligne 2 pour exclure l'en-tête
        ' Calculer la moyenne de buts encaissés par match pour chaque équipe
        Dim goalsAgainst As Long
        Dim matchesPlayed As Long
        Dim averageGoalsConceded As Double
        
        ' Récupérer le nombre de buts encaissés et le nombre de matchs joués
        goalsAgainst = ws.Cells(i, "I").Value
        matchesPlayed = ws.Cells(i, "D").Value
        
        ' Vérifier si le nombre de matchs joués est supérieur à zéro pour éviter la division par zéro
        If matchesPlayed > 0 Then
            ' Calculer la moyenne de buts encaissés par match
            averageGoalsConceded = goalsAgainst / matchesPlayed
        Else
            ' Si aucun match n'a été joué, la moyenne est 0
            averageGoalsConceded = 0
        End If
        
        ' Afficher la moyenne de buts encaissés par match dans la colonne L (colonne 12)
        ws.Cells(i, "L").Value = averageGoalsConceded
    Next i
End Sub

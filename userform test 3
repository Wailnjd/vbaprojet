
'Permet de quitter le Userform
Sub Valider_Click()
    Unload Me
End Sub

Sub UserForm_Initialize()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets("LeagueTableExport")
    Dim derniereLigne As Long
    derniereLigne = ws.Cells(ws.Rows.Count, "B").End(xlUp).Row
    
    Dim aEquipe1Modifiee As Boolean
    Dim aEquipe2Modifiee As Boolean ' ces booléens vont servir pour savoir quelle sub a été modifiée en premier
    aEquipe1Modifiee = False
    aEquipe2Modifiee = False
    
    Dim i As Long
    For i = 2 To derniereLigne
        Equipe1.AddItem ws.Cells(i, 2).Value
        Equipe2.AddItem ws.Cells(i, 2).Value
    Next i
End Sub
Sub Equipe1_Change()
    If Not aEquipe1Modifiee And Len(Equipe1.Value) > 0 Then
        aEquipe1Modifiee = True
        ' Appel de la mise à jour seulement si Equipe2 n'a pas été modifiée
        If Not aEquipe2Modifiee Then MiseAJourComboBox Equipe2, Equipe1
    End If
End Sub
Sub Equipe2_Change()
  If Not aEquipe2Modifiee And Len(Equipe2.Value) > 0 Then
        aEquipe2Modifiee = True
        ' Appel de la mise à jour seulement si Equipe1 n'a pas été modifiée
        If Not aEquipe1Modifiee Then MiseAJourComboBox Equipe1, Equipe2
    End If
End Sub
Sub MiseAJourComboBox(ByVal ComboBoxAMettreAJour As ComboBox, ByVal ComboBoxReference As ComboBox)
    Dim i As Long
        Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets("LeagueTableExport")
    ComboBoxAMettreAJour.Clear ' Efface les éléments actuels
    
    ' Remplir la ComboBox en excluant l'équipe sélectionnée dans l'autre ComboBox
    For i = 2 To ws.Cells(ws.Rows.Count, "B").End(xlUp).Row
        If ws.Cells(i, 1).Value <> ComboBoxReference.Value Then
            ComboBoxAMettreAJour.AddItem ws.Cells(i, 2).Value
        End If
    Next i
End Sub

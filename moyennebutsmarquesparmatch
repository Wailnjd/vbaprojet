Sub CalculerMoyenneButsMarquesParMatch()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    
    ' Spécifiez la feuille de calcul contenant les données
    Set ws = ThisWorkbook.Sheets("LeagueTableExport")
    
    ' Trouver la dernière ligne avec des données
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Parcourir les lignes du tableau
    For i = 2 To lastRow ' Commence à la ligne 2 pour exclure l'en-tête
        ' Calculer la moyenne de buts marqués par match pour chaque équipe
        Dim goalsFor As Long
        Dim matchesPlayed As Long
        Dim averageGoals As Double
        
        ' Récupérer le nombre de buts marqués et le nombre de matchs joués
        goalsFor = ws.Cells(i, "H").Value
        matchesPlayed = ws.Cells(i, "D").Value
        
        ' Vérifier si le nombre de matchs joués est supérieur à zéro pour éviter la division par zéro
        If matchesPlayed > 0 Then
            ' Calculer la moyenne de buts marqués par match
            averageGoals = goalsFor / matchesPlayed
        Else
            ' Si aucun match n'a été joué, la moyenne est 0
            averageGoals = 0
        End If
        
        ' Afficher la moyenne de buts marqués par match dans la colonne K (colonne 11)
        ws.Cells(i, "K").Value = averageGoals
    Next i
End Sub
